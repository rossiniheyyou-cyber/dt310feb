{"is_source_file": true, "format": "JavaScript", "description": "This file defines Express.js route handlers for managing lessons, including CRUD operations, AI content generation, and storage URL handling. It includes endpoints for listing, creating, updating, deleting lessons, and generating AI summaries/quizzes.", "external_files": ["../middleware/auth", "../middleware/rbac", "../config/db", "../services/ai", "../services/storage"], "external_methods": ["getDataSource", "createAIService", "getUploadPresignedUrl", "getPresignedUrl"], "published": ["router"], "classes": [], "methods": [{"name": "normalizeStoredQuiz", "description": "Normalizes quiz data stored in the database, handling null, JSON, or stringified JSON formats."}, {"name": "computeQuizScore", "description": "Calculates the number of correct answers, total questions, and percentage score for a quiz."}, {"name": "toLessonResponse", "description": "Transforms a lesson entity into a response object suitable for API output."}, {"name": "validateCreatePayload", "description": "Validates and sanitizes input data for creating a lesson."}, {"name": "validateUpdatePayload", "description": "Validates and prepares update data for an existing lesson."}, {"name": "parseListQueryParams", "description": "Parses and validates query parameters for listing lessons."}, {"name": "isValidId", "description": "Checks if a raw input is a valid positive integer ID."}, {"name": "normalizeString", "description": "Trims and normalizes string input, returning empty string or null for invalid inputs."}], "calls": ["getDataSource", "createAIService", "getUploadPresignedUrl", "getPresignedUrl", "ds.getRepository", "repository.findOne", "repository.save", "repository.update", "repository.create", "repository.find", "createAIService().generateSummary", "createAIService().generateQuiz"], "search-terms": ["lessons route", "AI content generation", "lesson storage URLs", "lesson CRUD", "lesson list with filters", "lesson AI quiz", "lesson video upload", "lesson video view URL"], "state": 2, "ctags": [], "filename": "version_1/lms_backend/src/routes/lessons.js", "format-version": 4, "code-base-name": "https://github.com/rossiniheyyou-cyber/dt310feb.git:kavia-main-1431", "knowledge_revision": 339, "git_revision": "a909b4454721f96265e3e16590e1fcd4bbdca8df", "revision_history": [{"339": "a909b4454721f96265e3e16590e1fcd4bbdca8df"}]}