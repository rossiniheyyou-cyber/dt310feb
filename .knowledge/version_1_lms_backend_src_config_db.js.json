{"is_source_file": true, "format": "JavaScript", "description": "This file configures and manages the database connection for a Node.js application using TypeORM with MySQL. It includes functions for building connection options from environment variables, initializing a singleton DataSource, and checking database connectivity.", "external_files": ["../entities/User", "../entities/Course", "../entities/Lesson", "../entities/MediaMetadata", "../entities/Notification", "../entities/AiQuizAttempt", "../entities/Quiz", "../entities/QuizAttempt", "../entities/UserProgress", "../entities/CourseCompletion", "../entities/CourseEnrollment"], "external_methods": ["path.join", "fs.existsSync", "fs.readFileSync", "Number.parseInt", "console.log"], "published": ["initializeDataSource", "checkDatabaseConnectivity", "getConfiguredDbName", "getDataSource", "createDataSourceFromEnv", "getDbMeta"], "classes": [], "methods": [{"name": "parseIntEnv", "description": "Safely parses an environment variable into an integer, returning a fallback if parsing fails."}, {"name": "describeTarget", "description": "Creates a minimal string description of the database target (host:port/database)."}, {"name": "buildMySqlSslOptionsFromEnv", "description": "Builds SSL options for MySQL connection based on environment variables, including CA certificate handling."}, {"name": "buildMySqlDataSourceOptionsFromEnv", "description": "Constructs the configuration object for MySQL DataSource from environment variables, including connection pooling and entity paths."}, {"name": "getDataSource", "description": "Returns the singleton DataSource instance if initialized."}, {"name": "getDbMeta", "description": "Returns non-secret metadata about the configured database."}, {"name": "createDataSourceFromEnv", "description": "Creates a new DataSource instance from environment variables without initializing it."}, {"name": "initializeDataSource", "description": "Initializes the singleton DataSource, establishing a database connection, with race condition handling."}, {"name": "checkDatabaseConnectivity", "description": "Performs a simple query to verify database connectivity, returning true or false."}, {"name": "getConfiguredDbName", "description": "Returns the configured database name from environment variables."}], "calls": ["path.join", "fs.existsSync", "fs.readFileSync", "Number.parseInt", "console.log", "require", "buildMySqlSslOptionsFromEnv", "buildMySqlDataSourceOptionsFromEnv", "new DataSource", "appDataSource.initialize", "appDataSource.query"], "search-terms": ["TypeORM", "MySQL", "database connection", "environment variables", "DataSource singleton", "SSL options", "migration path", "connection pool"], "state": 2, "ctags": [], "filename": "version_1/lms_backend/src/config/db.js", "format-version": 4, "code-base-name": "https://github.com/rossiniheyyou-cyber/dt310feb.git:kavia-main-1431", "knowledge_revision": 326, "git_revision": "a909b4454721f96265e3e16590e1fcd4bbdca8df", "revision_history": [{"326": "a909b4454721f96265e3e16590e1fcd4bbdca8df"}]}