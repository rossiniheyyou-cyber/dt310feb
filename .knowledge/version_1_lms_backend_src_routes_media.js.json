{"is_source_file": true, "format": "JavaScript", "description": "Express.js route handlers for media file upload/download via presigned S3 URLs, including access control and metadata management.", "external_files": ["../config/db", "../services/storage", "../middleware/auth", "../middleware/rbac"], "external_methods": ["getDataSource", "getUploadPresignedUrl", "getPresignedUrl"], "published": ["router"], "classes": [], "methods": [{"name": "isValidId", "description": "Validates if a raw input is a positive integer ID."}, {"name": "sanitizeFileName", "description": "Sanitizes filename for safe S3 key usage."}, {"name": "buildS3Key", "description": "Constructs S3 object key based on content category and IDs."}, {"name": "checkContentAccess", "description": "Checks if a user has access to specific content based on role and content type."}], "calls": ["getDataSource", "getRepository", "getUploadPresignedUrl", "getPresignedUrl", "mediaRepo.create", "mediaRepo.save", "mediaRepo.findOne"], "search-terms": ["media upload download", "presigned URL", "S3 storage", "access control", "media metadata", "media routes", "media.js"], "state": 2, "ctags": [], "filename": "version_1/lms_backend/src/routes/media.js", "format-version": 4, "code-base-name": "https://github.com/rossiniheyyou-cyber/dt310feb.git:kavia-main-1431", "knowledge_revision": 340, "git_revision": "a909b4454721f96265e3e16590e1fcd4bbdca8df", "revision_history": [{"340": "a909b4454721f96265e3e16590e1fcd4bbdca8df"}]}